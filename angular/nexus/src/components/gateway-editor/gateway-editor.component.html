<div class="h-full overflow-y-auto bg-[rgb(var(--color-surface))] p-8">
  @if (profile()) {
    <div class="space-y-8 max-w-4xl mx-auto">
      <!-- Header -->
      <div
        class="flex items-center justify-between border-b border-[rgb(var(--color-border-base))] pb-6"
      >
        <div>
          <h2
            class="text-2xl font-bold text-[rgb(var(--color-text-prominent))] flex items-center gap-3"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-8 w-8 text-[rgb(var(--color-accent-solid-bg))]"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"
              />
            </svg>
            {{ profile()!.name }}
          </h2>
          <p class="mt-1 text-sm text-[rgb(var(--color-text-muted))]">
            Broker Gateway Configuration
          </p>
        </div>
        <div class="flex items-center space-x-3">
          @if (isMounted()) {
            <span
              class="flex items-center gap-1.5 text-xs font-bold text-[rgb(var(--color-success-text))] bg-[rgb(var(--color-success-bg))] px-3 py-1 rounded-full border border-[rgb(var(--color-success-border))]"
            >
              <span
                class="w-2 h-2 rounded-full bg-[rgb(var(--color-success-text))] animate-pulse"
              ></span>
              MOUNTED
            </span>
          } @else {
            <span
              class="text-xs font-bold text-[rgb(var(--color-text-subtle))] bg-[rgb(var(--color-surface-muted))] px-3 py-1 rounded-full border border-[rgb(var(--color-border-muted))]"
            >
              DISCONNECTED
            </span>
          }

          @if (saveSuccess()) {
            <span
              class="text-sm text-[rgb(var(--color-success-text))] flex items-center animate-in fade-in slide-in-from-right-4 duration-300"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5 mr-1"
                viewBox="0 0 20 20"
                fill="currentColor"
              >
                <path
                  fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                  clip-rule="evenodd"
                />
              </svg>
              Changes Saved
            </span>
          }
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <!-- Left Column: Core Settings -->
        <div class="space-y-6">
          <div class="space-y-4">
            <h3
              class="text-xs font-semibold text-[rgb(var(--color-text-subtle))] uppercase tracking-wider"
            >
              Connection Settings
            </h3>

            <div class="relative group">
              <input
                type="text"
                name="name"
                required
                [ngModel]="formState().name"
                (ngModelChange)="updateField('name', $event)"
                placeholder="Profile Name"
                class="block w-full text-lg font-medium border-x-0 border-t-0 border-b-2 border-[rgb(var(--color-border-muted))] bg-transparent px-0 py-2 focus:ring-0 focus:border-[rgb(var(--color-accent-ring))] transition-all placeholder:text-[rgb(var(--color-text-subtle))]/50"
              />
              <div
                class="absolute bottom-0 left-0 w-0 h-0.5 bg-[rgb(var(--color-accent-solid-bg))] group-focus-within:w-full transition-all duration-300"
              ></div>
            </div>

            <div class="relative group">
              <input
                type="text"
                name="brokerUrl"
                [ngModel]="formState().brokerUrl"
                (ngModelChange)="updateField('brokerUrl', $event)"
                placeholder="Broker Gateway URL (e.g., localhost:8080)"
                class="block w-full border-x-0 border-t-0 border-b border-[rgb(var(--color-border-muted))] bg-transparent px-0 py-3 focus:ring-0 focus:border-[rgb(var(--color-accent-ring))] transition-all placeholder:text-[rgb(var(--color-text-subtle))]/50"
              />
            </div>

            <div class="relative group">
              <input
                type="text"
                name="imageUrl"
                [ngModel]="formState().imageUrl"
                (ngModelChange)="updateField('imageUrl', $event)"
                placeholder="Image Server Base URL"
                class="block w-full border-x-0 border-t-0 border-b border-[rgb(var(--color-border-muted))] bg-transparent px-0 py-3 focus:ring-0 focus:border-[rgb(var(--color-accent-ring))] transition-all placeholder:text-[rgb(var(--color-text-subtle))]/50"
              />
            </div>
          </div>
        </div>

        <!-- Right Column: Advanced & Behavior -->
        <div class="space-y-6">
          <div class="space-y-4">
            <h3
              class="text-xs font-semibold text-[rgb(var(--color-text-subtle))] uppercase tracking-wider"
            >
              System Behavior
            </h3>

            <div
              class="bg-[rgb(var(--color-surface-muted))] rounded-xl p-6 border border-[rgb(var(--color-border-muted))] space-y-6"
            >
              <div class="flex items-center justify-between">
                <div class="flex flex-col">
                  <span class="text-sm font-medium text-[rgb(var(--color-text-prominent))]"
                    >Auto-Connect</span
                  >
                  <span class="text-xs text-[rgb(var(--color-text-muted))]"
                    >Connect automatically on application startup</span
                  >
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input
                    type="checkbox"
                    [ngModel]="formState().autoConnect"
                    (ngModelChange)="updateField('autoConnect', $event)"
                    class="sr-only peer"
                  />
                  <div
                    class="w-11 h-6 bg-[rgb(var(--color-border-base))] peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[rgb(var(--color-accent-solid-bg))]"
                  ></div>
                </label>
              </div>

              <div class="space-y-3">
                <div class="flex flex-col">
                  <span class="text-sm font-medium text-[rgb(var(--color-text-prominent))]"
                    >Health Check Frequency</span
                  >
                  <span class="text-xs text-[rgb(var(--color-text-muted))]"
                    >Polling interval in minutes</span
                  >
                </div>
                <div class="relative flex items-center">
                  <input
                    type="number"
                    name="healthCheckDelayMinutes"
                    min="1"
                    [ngModel]="formState().healthCheckDelayMinutes"
                    (ngModelChange)="updateField('healthCheckDelayMinutes', $event)"
                    placeholder="3"
                    class="block w-24 border border-[rgb(var(--color-border-muted))] rounded-lg bg-[rgb(var(--color-surface))] px-3 py-2 text-sm focus:ring-1 focus:ring-[rgb(var(--color-accent-ring))] focus:border-[rgb(var(--color-accent-ring))] transition-all"
                  />
                  <span class="ml-3 text-xs text-[rgb(var(--color-text-muted))]">minutes</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  } @else {
    <div
      class="h-full flex flex-col items-center justify-center text-[rgb(var(--color-text-muted))] opacity-40"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-24 w-24 mb-6"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="1"
          d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"
        />
      </svg>
      <p class="text-xl font-light tracking-wide uppercase">Gateway profile not found</p>
    </div>
  }
</div>
